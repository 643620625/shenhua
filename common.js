// ===== 公共数据 =====
const rawPool=[
// 白50% 40人
["土地公",1],["城隍",1],["灶神",1],["门神",1],["井神",1],["厕神",1],["路神",1],["桥神",1],["船神",1],["车神",1],
["山神",1],["河神",1],["花神",1],["树神",1],["石神",1],["夜游神",1],["日巡游",1],["夜巡游",1],["功曹",1],["土地奶奶",1],
["灶王奶奶",1],["井龙王",1],["船官",1],["车官",1],["路官",1],["桥官",1],["花仙子",1],["草仙",1],["竹仙",1],["松仙",1],
["柳仙",1],["狐仙",1],["黄仙",1],["白仙",1],["灰仙",1],["蛇仙",1],["狸仙",1],["龟仙",1],["鹤仙",1],["蛙仙",1],
// 绿30% 30人
["嫦娥",3],["月老",3],["雷公",3],["电母",3],["风伯",3],["雨师",3],["龙王",3],["河伯",3],["洛神",3],["妈祖",3],
["钟馗",3],["二郎神",4],["哪吒",4],["托塔天王",4],["太白金星",3],["文曲星",3],["武曲星",3],["寿星",3],["福星",3],["禄星",3],
["财神",3],["药王",3],["鲁班",3],["关羽",4],["秦琼",3],["尉迟恭",3],["黑白无常",3],["牛头",3],["马面",3],["孟婆",3],
// 蓝12% 28人
["铁拐李",5],["汉钟离",5],["张果老",5],["吕洞宾",5],["何仙姑",5],["蓝采和",5],["韩湘子",5],["曹国舅",5],
["七仙女",5],["织女",5],["董永",5],["沉香",5],["后羿",5],["夸父",5],["精卫",5],["共工",5],["祝融",5],["刑天",5],
["蚩尤",5],["九天玄女",5],["瑶姬",5],["麻姑",5],["彭祖",5],["鬼谷子",5],["左慈",5],["于吉",5],["葛洪",5],["孙思邈",5],
// 黄5% 26人
["齐天大圣",8],["天蓬元帅",7],["卷帘大将",7],["金蝉子",7],["托塔李天王",7],["增长天王",7],["持国天王",7],["广目天王",7],["多闻天王",7],
["二十八宿",7],["角木蛟",6],["亢金龙",6],["奎木狼",6],["三十六天罡",7],["七十二地煞",7],["十殿阎罗",7],["秦广王",6],["楚江王",6],["宋帝王",6],
["五方五老",7],["东华帝君",7],["西王母",7],["九天应元雷声普化天尊",7],["南极长生大帝",7],["北极紫微大帝",7],
// 橙2.5% 30人
["玉皇大帝",12],["王母娘娘",11],["太上老君",12],["元始天尊",12],["灵宝天尊",12],["如来佛祖",12],["观音菩萨",11],["地藏菩萨",11],["文殊菩萨",11],["普贤菩萨",11],
["弥勒佛",11],["燃灯古佛",11],["阿弥陀佛",11],["药师佛",11],["孔雀大明王",10],["金灵圣母",10],["无当圣母",10],["龟灵圣母",10],["赵公明",10],["云霄",10],
["琼霄",9],["碧霄",9],["广成子",9],["赤精子",9],["太乙真人",9],["黄龙真人",9],["文殊广法天尊",9],["普贤真人",9],["慈航道人",9],["道行天尊",9],
// 红0.5% 20人
["盘古",20],["女娲",18],["伏羲",18],["神农",17],["黄帝",17],["炎帝",17],["蚩尤",16],["东皇太一",19],["帝俊",19],["羲和",17],
["常羲",17],["望舒",17],["夸父",16],["刑天",16],["共工",16],["祝融",16],["后土",18],["玄冥",17],["蓐收",17],["句芒",17]
];
const pool = [];
rawPool.forEach(([n,h]) => pool.push({name:n,hp:h}));

function getColor(c){
  const h = c.hp;
  return h <= 2 ? "white" : 
         h <= 4 ? "green" : 
         h <= 6 ? "blue" : 
         h <= 8 ? "gold" : 
         h <= 12 ? "orange" : "red";
}

// ===== 全局状态 =====
window.G = {
  owned: [],       // 已拥有卡名（去重）
  lastDraw: [],    // 最近抽卡记录
  countMap: {},     // 同名卡抽到次数
};

// 静音版：只读写，不弹窗
function saveSilent(){
  localStorage.setItem("myth_save", JSON.stringify(G));
}

function loadSilent(){
  const s = localStorage.getItem("myth_save");
  if(!s) {
    // 如果是首次使用，初始化空状态
    G.owned = [];
    G.lastDraw = [];
    G.countMap = {};
    return false;
  }
  const d = JSON.parse(s);
  G.owned = d.owned || [];
  G.lastDraw = d.lastDraw || [];
  G.countMap = d.countMap || {};
  return true;
}

// 一键重置
function reset(){
  G.owned = [];
  G.lastDraw = [];
  G.countMap = {};
  saveSilent();
  alert("已重置");
}